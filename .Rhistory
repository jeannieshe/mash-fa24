# load in data
X_Govaere <- readRDS("X_Govaere.rds")
setwd("~/Desktop/fa24-urop")
# load in data
X_Govaere <- readRDS("X_Govaere.rds")
View(X_Govaere)
")
X_Pantano <- readRDS("X_Pantano.rds")
X_Hoang <- readRDS("X_Hoang.rds")
X_Pantano <- readRDS("X_Pantano.rds")
Y_Govaere <- readRDS("Y_Govaere.rds")
Y_Hoang <- readRDS("Y_Hoang.rds")
Y_Pantano <- readRDS("Y_Pantano.rds")
?fgsea
# load in libraries
library(tidyverse)
library(RColorBrewer)
library(fgsea)
View(Y_Govaere)
# first need to perform deseq to get a list of genes and their corresponding pvalues in each dataset
library(DESeq2)
BiocManager::install("fgsea")
install.packages("BiocManager")
BiocManager::install("fgsea")
BiocManager::install("DESeq2")
library(DESeq2)
library(fgsea)
?DESeqDataSetFromMatrix
# countData must have genes in the rows and samples in the columns
X_Govaere.transpose()
?transpose
# countData must have genes in the rows and samples in the columns
transpose(X_Govaere)
# countData must have genes in the rows and samples in the columns
t(X_Govaere)
View(X_Govaere)
# countData must have genes in the rows and samples in the columns
X_Govaere <-t(X_Govaere)
View(X_Govaere)
?DESeqDataSetFromMatrix
dds <- DESeqDataSetFromMatrix(countData = X_Govaere,
colData = Y_Govaere,
design = ~ NAS + fibrosis)
View(X_Govaere)
View(X_Govaere)
# begin by performing limma for differential expression analysis on the datasets
X_data <- c("X_Govaere", "X_Hoang", "X_Pantano")
Y_data <- c("Y_Govaere", "Y_Hoang", "Y_Pantano")
X_name <- X_data[ii]
ii <- 1
X_name <- X_data[ii]
X <- get(X_name)
X_data <- c("X_Govaere")
Y_data <- c("Y_Govaere")
for (ii in 1:length(X_data)) {
X_name <- X_data[ii]
Y_name <- Y_data[ii]
X <- get(X_name)
Y <- get(Y_name)
X <- t(X)
Y <- as.data.frame(Y)
# begin by performing limma for differential expression analysis on the datasets
design <- model.matrix(~ NAS + fibrosis, data = Y)
fit <- lmFit(X, design) # linear modelling
fit <- eBayes(fit) # empirical Bayes moderation carried out to obtain precise estimates of gene-wise variability
# for eBayes(fit), set robust=TRUE, trend=TRUE if log-transformed normalized data
# summary(decideTests(fit))
diffex_NAS <- topTable(fit, coef = "NAS", n = Inf)
diffex_fib <- topTable(fit, coef = "fibrosis", n = Inf)
# then run fgsea() with the pathways
# should i just use the t-statistic? why or why not select any other stat?
tstat_NAS <- diffex_NAS$t
names(tstat_NAS) <- rownames(diffex_NAS)
fgsea_NAS <- fgsea(
pathways = gene_sets,
stats = tstat_NAS,
nperm = 1000) #error: there are ties in the preranked stats (1.96%)
fgsea_Govaere <- fgsea_NAS[, c("pathway", "NES")]
colnames(fgsea_Govaere) <- c("Pathway", "NES", "DiffEx")
fgsea_Govaere$DiffEx <- c("NAS", "NAS")
}
library(tidyverse)
library(RColorBrewer)
library(fgsea)
library(limma)
for (ii in 1:length(X_data)) {
X_name <- X_data[ii]
Y_name <- Y_data[ii]
X <- get(X_name)
Y <- get(Y_name)
X <- t(X)
Y <- as.data.frame(Y)
# begin by performing limma for differential expression analysis on the datasets
design <- model.matrix(~ NAS + fibrosis, data = Y)
fit <- lmFit(X, design) # linear modelling
fit <- eBayes(fit) # empirical Bayes moderation carried out to obtain precise estimates of gene-wise variability
# for eBayes(fit), set robust=TRUE, trend=TRUE if log-transformed normalized data
# summary(decideTests(fit))
diffex_NAS <- topTable(fit, coef = "NAS", n = Inf)
diffex_fib <- topTable(fit, coef = "fibrosis", n = Inf)
# then run fgsea() with the pathways
# should i just use the t-statistic? why or why not select any other stat?
tstat_NAS <- diffex_NAS$t
names(tstat_NAS) <- rownames(diffex_NAS)
fgsea_NAS <- fgsea(
pathways = gene_sets,
stats = tstat_NAS,
nperm = 1000) #error: there are ties in the preranked stats (1.96%)
fgsea_Govaere <- fgsea_NAS[, c("pathway", "NES")]
colnames(fgsea_Govaere) <- c("Pathway", "NES", "DiffEx")
fgsea_Govaere$DiffEx <- c("NAS", "NAS")
}
head(X)
View(X)
for (ii in 1:length(X_data)) {
X_name <- X_data[ii]
Y_name <- Y_data[ii]
X <- get(X_name)
Y <- get(Y_name)
X <- t(X)
Y <- as.data.frame(Y)
# begin by performing limma for differential expression analysis on the datasets
design <- model.matrix(~ NAS + fibrosis, data = Y)
fit <- lmFit(X, design) # linear modelling
fit <- eBayes(fit) # empirical Bayes moderation carried out to obtain precise estimates of gene-wise variability
# for eBayes(fit), set robust=TRUE, trend=TRUE if log-transformed normalized data
# summary(decideTests(fit))
diffex_NAS <- topTable(fit, coef = "NAS", n = Inf)
diffex_fib <- topTable(fit, coef = "fibrosis", n = Inf)
# then run fgsea() with the pathways
# should i just use the t-statistic? why or why not select any other stat?
tstat_NAS <- diffex_NAS$t
names(tstat_NAS) <- rownames(diffex_NAS)
fgsea_NAS <- fgsea(
pathways = gene_sets,
stats = tstat_NAS,
nperm = 1000) #error: there are ties in the preranked stats (1.96%)
fgsea_Govaere <- fgsea_NAS[, c("pathway", "NES")]
colnames(fgsea_Govaere) <- c("Pathway", "NES", "DiffEx")
fgsea_Govaere$DiffEx <- c("NAS", "NAS")
}
View(X)
X <- t(X)
View(X)
# begin by performing limma for differential expression analysis on the datasets
design <- model.matrix(~ NAS + fibrosis, data = Y)
fit <- lmFit(X, design) # linear modelling
fit <- eBayes(fit) # empirical Bayes moderation carried out to obtain precise estimates of gene-wise variability
# summary(decideTests(fit))
diffex_NAS <- topTable(fit, coef = "NAS", n = Inf)
diffex_fib <- topTable(fit, coef = "fibrosis", n = Inf)
# then run fgsea() with the pathways
# should i just use the t-statistic? why or why not select any other stat?
tstat_NAS <- diffex_NAS$t
names(tstat_NAS) <- rownames(diffex_NAS)
fgsea_NAS <- fgsea(
pathways = gene_sets,
stats = tstat_NAS,
nperm = 1000) #error: there are ties in the preranked stats (1.96%)
gene_sets <- list(
"gNAS" = gNAS,
"gFib" = gFib
)
# initialize signatures
gNAS <- c("ARPC5", "YWHAH", "ARF4", "TNFRSF12A", "ADHFE1",
"USP33", "CD52", "ACVR2B", "ING5", "ASB3", "IFI30",
"ERVW-1", "YWHAZ", "ERBB3", "KPNA2", "COQ10B", "MAGI1",
"MAPRE1", "ABCA6")
gFib <- c("TIMP1", "MYLI2B", "LUM", "ZNF395", "AKAP9",
"ACTR2", "LGALS3", "MAPRE1", "FRK", "ANKRD28",
"IGFBP7", "YWHAZ", "USP33", "CD59", "TAX1BP3",
"FAM221A", "ADHFE1", "TNFRSF12A")
gene_sets <- list(
"gNAS" = gNAS,
"gFib" = gFib
)
fgsea_NAS <- fgsea(
pathways = gene_sets,
stats = tstat_NAS,
nperm = 1000) #error: there are ties in the preranked stats (1.96%)
fgsea_Govaere <- fgsea_NAS[, c("pathway", "NES")]
colnames(fgsea_Govaere) <- c("Pathway", "NES", "DiffEx")
colnames(fgsea_Govaere) <- c("Pathway", "NES")
fgsea_Govaere
View(fgsea_Govaere)
fgsea_Govaere-NASt <- fgsea_NAS[, c("pathway", "NES")]
colnames(fgsea_Govaere-NASt) <- c("Pathway", "NES")
fgsea_Govaere_NASt <- fgsea_NAS[, c("pathway", "NES")]
colnames(fgsea_Govaere_NASt) <- c("Pathway", "NES")
fgsea_Govaere_NASt$DiffEx <- c("NAS", "NAS")
View(fgsea_Govaere_NASt)
head(fit)
topTable(fit)
?sprint
??sprintf
sprint("X_%s", X_name)
sprintf("X_%s", X_name)
datasets <- c("Govaere", "Hoang", "Pantano")
datasets <- c("Govaere", "Hoang", "Pantano")
ii = 1
name <- datasets[ii]
sprintf("X_%s", name)
X <- get(sprintf("X_%s", name))
datasets <- c("Govaere", "Hoang", "Pantano")
library(tidyverse)
library(RColorBrewer)
library(fgsea)
library(limma)
X_Govaere <- readRDS("datasets/X_Govaere.rds")
X_Hoang <- readRDS("datasets/X_Hoang.rds")
X_Pantano <- readRDS("datasets/X_Pantano.rds")
Y_Govaere <- readRDS("datasets/Y_Govaere.rds")
Y_Hoang <- readRDS("datasets/Y_Hoang.rds")
Y_Pantano <- readRDS("datasets/Y_Pantano.rds")
gNAS <- c("ARPC5", "YWHAH", "ARF4", "TNFRSF12A", "ADHFE1",
"USP33", "CD52", "ACVR2B", "ING5", "ASB3", "IFI30",
"ERVW-1", "YWHAZ", "ERBB3", "KPNA2", "COQ10B", "MAGI1",
"MAPRE1", "ABCA6")
gFib <- c("TIMP1", "MYLI2B", "LUM", "ZNF395", "AKAP9",
"ACTR2", "LGALS3", "MAPRE1", "FRK", "ANKRD28",
"IGFBP7", "YWHAZ", "USP33", "CD59", "TAX1BP3",
"FAM221A", "ADHFE1", "TNFRSF12A")
gene_sets <- list(
"gNAS" = gNAS,
"gFib" = gFib
)
datasets <- c("Govaere", "Hoang", "Pantano")
for (ii in 1:length(datasets)) {
name <- datasets[ii]
X <- get(sprintf("X_%s", name))
Y <- get(sprintf("Y_%s", name))
X <- t(X)
Y <- as.data.frame(Y)
# begin by performing limma for differential expression analysis on the datasets
design <- model.matrix(~ NAS + fibrosis, data = Y)
fit <- lmFit(X, design) # linear modelling
fit <- eBayes(fit) # empirical Bayes moderation carried out to obtain precise estimates of gene-wise variability
# for eBayes(fit), set robust=TRUE, trend=TRUE if log-transformed normalized data
# summary(decideTests(fit))
diffex_NAS <- topTable(fit, coef = "NAS", n = Inf)
diffex_fib <- topTable(fit, coef = "fibrosis", n = Inf)
# then run fgsea() with the pathways
# should i just use the t-statistic? why or why not select any other stat?
tstat_NAS <- diffex_NAS$t
names(tstat_NAS) <- rownames(diffex_NAS)
fgsea_NAS <- fgsea(
pathways = gene_sets,
stats = tstat_NAS,
nperm = 1000) #error: there are ties in the preranked stats (1.96%)
tstat_fib <- diffex_fib$t
names(tstat_fib) <- rownames(diffex_fib)
fgsea_fib <- fgsea(
pathways = gene_sets,
stats = tstat_fib,
nperm = 1000) #error: there are ties in the preranked stats (1.96%)
# store the NES values in a dataframe
fgsea_NASt <- fgsea_NAS[, c("pathway", "NES")]
colnames(fgsea_NASt) <- c("Pathway", "NES")
fgsea_NASt$dataset <- c(sprintf("%s", name), sprintf("%s", name))
fgsea_NASt$tstatFrom <- c("NAS", "NAS")
fgsea_fibt <- fgsea_fib[, c("pathway", "NES")]
colnames(fgsea_fibt) <- c("Pathway", "NES")
fgsea_fibt$dataset <- c(sprintf("%s", name), sprintf("%s", name))
fgsea_fibt$tstatFrom <- c("Fib", "Fib")
}
View(fgsea_NASt)
View(fgsea_NAS)
View(fgsea_NASt)
datasets <- c("Govaere", "Hoang", "Pantano")
fgsea_NASt <- data.frame(pathway = character(), NES = numeric(), dataset = character(), stringsAsFactors = FALSE) #tstat from fgsea is NAS coefficient
fgsea_Fibt <- data.frame(pathway = character(), NES = numeric(), dataset = character(), stringsAsFactors = FALSE) #tstat from fgsea is Fibrosis coefficient
for (ii in 1:length(datasets)) {
name <- datasets[ii]
X <- get(sprintf("X_%s", name))
Y <- get(sprintf("Y_%s", name))
X <- t(X)
Y <- as.data.frame(Y)
# begin by performing limma for differential expression analysis on the datasets
design <- model.matrix(~ NAS + fibrosis, data = Y)
fit <- lmFit(X, design) # linear modelling
fit <- eBayes(fit) # empirical Bayes moderation carried out to obtain precise estimates of gene-wise variability
# for eBayes(fit), set robust=TRUE, trend=TRUE if log-transformed normalized data
# summary(decideTests(fit))
diffex_NAS <- topTable(fit, coef = "NAS", n = Inf)
diffex_fib <- topTable(fit, coef = "fibrosis", n = Inf)
# then run fgsea() with the pathways
# should i just use the t-statistic? why or why not select any other stat?
tstat_NAS <- diffex_NAS$t
names(tstat_NAS) <- rownames(diffex_NAS)
fgsea_NAS <- fgsea(
pathways = gene_sets,
stats = tstat_NAS,
nperm = 1000) #error: there are ties in the preranked stats (1.96%)
tstat_fib <- diffex_fib$t
names(tstat_fib) <- rownames(diffex_fib)
fgsea_fib <- fgsea(
pathways = gene_sets,
stats = tstat_fib,
nperm = 1000) #error: there are ties in the preranked stats (1.96%)
# store the NES values in a dataframe
temp_NASdf <- fgsea_NAS[, c("pathway", "NES")]
temp_NASdf$dataset <- name
fgsea_NASt <- rbind(fgsea_NASt, temp_NASdf)
temp_Fibdf <- fgsea_fib[, c("pathway", "NES")]
temp_Fibdf$dataset <- name
fgsea_Fibt <- rbind(fgsea_Fibt, temp_Fibdf)
}
View(fgsea_Fibt)
View(fgsea_NASt)
?saveRDS
saveRDS(fgsea_NASt, "datasets/fgsea_NASt.rds")
saveRDS(fgsea_Fibt, "datasets/fgsea_Fibt.rds")
getwd()
setwd(~Documents/GitHub/mash-fa24)
setwd("~Documents/GitHub/mash-fa24")
setwd("~/Documents/GitHub/mash-fa24")
saveRDS(fgsea_NASt, "datasets/fgsea_NASt.rds")
saveRDS(fgsea_Fibt, "datasets/fgsea_Fibt.rds")
